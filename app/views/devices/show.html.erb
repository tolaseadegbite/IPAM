<% content_for :title, @device.name %>

<% content_for :page_header do %>
  <h4 class="font-semibold"><%= @device.name %></h4>
<% end %>

<% content_for :header_action_buttons do %>
  <div class="flex items-center gap-2">
    <%= link_to "Edit", edit_device_path(@device), class: "btn bg-orange-400", data: { turbo_frame: "modal" } %>
    <%= button_to "Delete", @device, method: :delete, class: "btn bg-white border border-red-200 text-red-600 font-semibold rounded px-4 py-2 hover:bg-red-50", form: { data: { turbo_confirm: "Are you sure? This will release the IP." } } %>
  </div>
<% end %>

<div class="absolute hide@md" style="bottom: 10rem; right: 1rem; z-index: 9999">
  <%= link_to edit_device_path(@device), class: "btn bg-orange-400 text-white font-semibold rounded-full p-5", data: { turbo_frame: "modal" } do %>
    <span class="icon icon--pen"></span>
  <% end %>
</div>

<div class="p-4">
  <div class="flex items-center justify-between mbe-6">
    <div class="flex items-center gap-4">
      <%= link_to devices_path, class: "btn btn--subtle btn--icon" do %>
        <span class="icon icon--chevron-left"></span>
      <% end %>
      <div>
        <h1 class="text-3xl font-bold"><%= @device.name %></h1>
        <div class="text-subtle text-sm uppercase font-bold tracking-wide"><%= @device.serial_number %></div>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 grid-cols-2@md gap-6">
    
    <%# --- Hardware Details --- %>
    <div class="col-span-1 card bg-main shadow-sm">
      <h3 class="font-bold text-lg mbe-4 border-be pbe-2">Hardware Info</h3>
      
      <div class="flex flex-col gap-4">
        <div>
          <label class="text-xs text-subtle uppercase font-bold">Type</label>
          <div class="text-lg"><%= @device.device_type.humanize %></div>
        </div>
        <div>
          <label class="text-xs text-subtle uppercase font-bold">Asset Tag</label>
          <div class="font-mono text-lg"><%= @device.asset_tag.presence || "N/A" %></div>
        </div>
        <div>
          <label class="text-xs text-subtle uppercase font-bold">Status</label>
          <div class="mt-1">
             <span class="bg-shade pi-3 pb-1 rounded-md text-sm font-bold uppercase"><%= @device.status %></span>
          </div>
        </div>
        <div>
          <label class="text-xs text-subtle uppercase font-bold">Notes</label>
          <p class="text-sm text-gray-700 bg-gray-50 p-2 rounded-md mt-1"><%= @device.notes.presence || "No notes." %></p>
        </div>
      </div>
    </div>

    <%# --- Network & Assignment --- %>
    <div class="col-span-1 flex flex-col gap-6">
      
      <%# Network Card %>
      <div class="card bg-white shadow-sm">
        <h3 class="font-bold text-lg mbe-4 border-be pbe-2 flex items-center gap-2">
          <span class="icon icon--globe"></span> Network
        </h3>
        <% if @device.ip_address %>
          <div class="text-center p-4 bg-green-50 border border-green-100 rounded-md">
             <div class="font-mono text-2xl font-bold text-green-700 mbe-1"><%= @device.ip_address.address %></div>
             <div class="text-sm text-green-600"><%= @device.ip_address.subnet.name %></div>
          </div>
        <% else %>
           <div class="text-center p-4 bg-gray-50 border border-dashed rounded text-subtle">
             No IP Address Assigned
           </div>
        <% end %>
      </div>

      <%# Owner Card %>
      <div class="card p-6 border rounded bg-white shadow-sm">
        <h3 class="font-bold text-lg mbe-4 border-be pbe-2 flex items-center gap-2">
          <span class="icon icon--user"></span> Assignment
        </h3>
        <% if @device.employee %>
          <div class="flex items-center gap-4">
             <div class="bg-shade rounded-full flex items-center justify-center text-lg font-bold border" style="block-size: 5rem; inline-size: 5rem;">
                <%= @device.employee.first_name.first %><%= @device.employee.last_name.first %>
             </div>
             <div>
               <div class="font-bold text-lg"><%= link_to @device.employee.full_name, @device.employee, class: "hover:underline" %></div>
               <div class="text-sm text-subtle"><%= @device.department.name %></div>
             </div>
          </div>
        <% else %>
          <div class="flex items-center gap-4 opacity-50">
             <div class="bg-gray-200 rounded-full w-12 h-12"></div>
             <div>Unassigned</div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>