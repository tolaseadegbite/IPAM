<div class="sidebar-menu">
  <%= link_to root_path, class: "flex items-center gap-2 rounded-lg border i-fit pi-2 mbs-2 mis-1" do %>
    <%= image_tag("logo.png", size: 30) %>
    <span class="text-2xl font-semibold">& AM</span>
  <% end %>

  <div class="sidebar-menu__content">
    
    <%# --- MAIN GROUP --- %>
    <div class="sidebar-menu__group">
      <div class="sidebar-menu__group-label">MAIN</div>
      <div class="sidebar-menu__items">
        <nav class="">
          <%# Dashboard usually doesn't have a resource controller, so current_page? is fine here %>
          <%= link_to dashboard_path, class: "flex gap-4 btn sidebar-menu__button mbe-1",
                      aria: (current_page?(dashboard_path) ? { current: "page" } : {}) do %>
            <span class="icon icon--chart-pie" aria-hidden="true"></span>
            Dashboard
          <% end %>

          <%= link_to branches_path, 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: active_for("branches") do %>
            <span class="icon icon--building" aria-hidden="true"></span>
            Branches
          <% end %>
          
          <%= link_to departments_path, 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: active_for("departments") do %>
            <span class="icon icon--warehouse" aria-hidden="true"></span>
            Departments
          <% end %>

          <%= link_to employees_path, 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: active_for("employees") do %>
            <span class="icon icon--users-round" aria-hidden="true"></span>
            Employees
          <% end %>
        </nav>
      </div>
    </div>

    <%# --- ASSET MANAGEMENT GROUP --- %>
    <div class="sidebar-menu__group">
      <div class="sidebar-menu__group-label">ASSET MANAGEMENT</div>
      <div class="sidebar-menu__items">
        <nav class="">
          <%= link_to subnets_path, 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: active_for("subnets") do %>
            <span class="icon icon--network" aria-hidden="true"></span>
            Subnets
          <% end %>

          <%# NOTE: We add extra logic here to NOT highlight this if we are looking at Rogue Devices (which shares the controller) %>
          <%= link_to ip_addresses_path, 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: (controller_name == "ip_addresses" && params[:q].blank? ? { current: "page" } : {}) do %>
            <span class="icon icon--map-pinned" aria-hidden="true"></span>
            Ip Addresses
          <% end %>

          <%= link_to devices_path, 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: (controller_name == "devices" && params[:q].blank? ? { current: "page" } : {}) do %>
            <span class="icon icon--monitor" aria-hidden="true"></span>
            Devices
          <% end %>
        </nav>
      </div>
    </div>
                       
    <%# --- SECURITY GROUP --- %>
    <div class="sidebar-menu__group">
      <div class="sidebar-menu__group-label">SECURITY</div>
      <div class="sidebar-menu__items">
        <nav class="">
          <%# Keep current_page? here because these rely on specific query params %>
          <%= link_to ip_addresses_path(q: { rogue_only: true }), 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: (current_page?(ip_addresses_path(q: { rogue_only: true })) ? { current: "page" } : {}) do %>
            <span class="icon icon--triangle-alert" aria-hidden="true"></span>
            Rogue Devices
          <% end %>

          <%= link_to devices_path(q: { critical_eq: true }), 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: (current_page?(devices_path(q: { critical_eq: true })) ? { current: "page" } : {}) do %>
            <span class="icon icon--monitor-x" aria-hidden="true"></span>
            Critical Devices
          <% end %>
        </nav>
      </div>
    </div>

    <%# --- USER MANAGEMENT --- %>
    <div class="sidebar-menu__group">
      <div class="sidebar-menu__group-label">USER MANAGEMENT & Audit</div>
      <div class="sidebar-menu__items">
        <nav class="">
          <%# Assuming this controller is named 'admin_users' or just 'users' (adjust string as needed) %>
          <%= link_to admin_users_path, 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: active_for("users") do %>
            <span class="icon icon--users" aria-hidden="true"></span>
            Users
          <% end %>

          <%# PaperTrail usually uses 'versions' controller %>
          <%= link_to versions_path, 
                      class: "flex gap-4 btn sidebar-menu__button mbe-1", 
                      aria: active_for("versions") do %>
            <span class="icon icon--history" aria-hidden="true"></span>
            History
          <% end %>
        </nav>
      </div>
    </div>
  </div>

  <%= render "layouts/navigation/dashboard/sidebar_bottom_menu" %>
</div>