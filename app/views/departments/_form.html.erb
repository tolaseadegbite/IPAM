<%= form_with(model: department, html: { contents: true }) do |form| %>
  <%= render "shared/error_messages", object: department %>

  <div class="grid grid-cols-1 grid-cols-2@md gap-4">
    <div class="col-span-1">
      <%= form.label :name, "Department Function", class: "block font-medium mbe-1" %>
      <%= form.select :name, Department::NAMES, { prompt: "Select Standard Department" }, { class: "input w-full p-2 border rounded cursor-pointer" } %>
    </div>

    <div class="col-span-1">
      <%= form.label :branch_id, class: "block font-medium mbe-1" %>
      
      <% if department.branch_id %>
        <%# 1. Hidden field to ensure value is sent %>
        <%= form.hidden_field :branch_id %>
        
        <%# 2. Disabled dropdown for display purposes only %>
        <%= form.collection_select :branch_id, 
              Branch.order(:name), :id, :name, 
              {}, # No prompt needed
              { class: "input w-full p-2 border rounded bg-gray-100 cursor-not-allowed", disabled: true } %>
      <% else %>
        <%# Standard Dropdown %>
        <%= form.collection_select :branch_id, 
              Branch.order(:name), :id, :name, 
              { prompt: "Select Branch" }, 
              { class: "input w-full p-2 border rounded cursor-pointer" } %>
      <% end %>
    </div>
  </div>

  <div class="mbs-4 flex gap-3 items-center">
    <%= form.submit class: "btn bg-orange-400 text-white font-semibold rounded pi-4 pb-2" %>
    <%= link_to "Cancel", departments_path, class: "text-subtle", data: { turbo_frame: "_top" } %>
  </div>
<% end %>